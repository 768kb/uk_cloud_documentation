<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>How to create a vApp network </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="How to create a vApp network ">
    <meta name="generator" content="docfx 2.58.4.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container-fluid">
            <div class="navbar-margin-left">
              <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                
                <a class="navbar-brand" href="../../index.html">
                  <img id="logo" class="svg" src="../../styles/assets/logo.png" srcset="../../styles/assets/logo@2x.png 2x" width="300" height="49" alt="">
                </a>
              </div>
              <div class="collapse navbar-collapse" id="navbar">
                <form class="navbar-form navbar-right" role="search" id="search">
                  <div class="form-group">
                    <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                  </div>
                </form>
              </div>
            </div>
          </div>
        </nav>
        
        <div class="navbar-borderless subnav navbar navbar-default">
          <div class="navbar-right subnav-margin-right">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/UKCloud/documentation/blob/master/articles/vmware/vmw-how-create-vapp-network.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
          </div>
          <div class="hide-when-search subnav-margin-left" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container-fluid body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="container-fluid">
            <div class="row">
              <div class="col-lg-10">
                <article class="content wrap" id="_content" data-uid="">
                  
<h1 id="how-to-create-a-vapp-network">How to create a vApp network</h1>

<h2 id="overview">Overview</h2>
<p>In addition to virtual data centre (VDC) networking, you can create individual vApp networks to have even greater control over your network infrastructure.</p>
<p>vApp networks enable you to create smaller networks within individual vApps that have a vApp edge, similar to the edge gateway on your VDC. Although a vApp edge isn't as feature rich as a VDC edge, it enables you to create firewall and NAT rules to separate your VDC networks from your vApp virtual machines (VMs). This means you can create some quite complex networks to satisfy application needs.</p>
<p>The vApp network diagram below shows the vApp edge.</p>
<p><img src="images/vmw-vapp-network.png" alt="vApp network"></p>
<h2 id="creating-a-vapp-network">Creating a vApp network</h2>
<div class="NOTE">
<h5>Note</h5>
<p>As you're going to be changing network settings, all VMs within the vApp must be powered off.</p>
</div>
<ol>
<li><p>In the VMware Cloud Director <em>Virtual Data Center</em> dashboard, select the VDC that contains the vApp.</p>
</li>
<li><p>In the left navigation panel, select <strong>vApps</strong>.</p>
<p><img src="images/vmw-vcd10.1-tab-vapps.png" alt="vApps tab in VMware Cloud Director"></p>
</li>
<li><p>In the card for the vApp, select <strong>Actions</strong>, then <strong>Add Network</strong>.</p>
<p><img src="images/vmw-vcd10.1-mnu-vapp-network.png" alt="Add Network menu option"></p>
</li>
<li><p>In the <em>Add Network</em> dialog box, select <strong>vApp Network</strong>.</p>
</li>
<li><p>Enter a <strong>Name</strong> and <strong>Description</strong> for the network.</p>
</li>
<li><p>In the <em>Address and DNS</em> section, fill out the fields as required for your network.</p>
<p><img src="images/vmw-vcd10.1-add-network-vapp.png" alt="Add vApp Network option"></p>
</li>
<li><p>When you're done, click <strong>Add</strong>.</p>
</li>
</ol>
<h2 id="connecting-a-vm-to-a-vapp-network">Connecting a VM to a vApp network</h2>
<p>If your vApp is already populated with VMs that are connected to a VDC network, you may want to move them over to the vApp network.</p>
<p>To change the network a VM connects to:</p>
<ol>
<li><p>In the card for the vApp, select <strong>Details</strong>.</p>
</li>
<li><p>Select <strong>Virtual Machines</strong>.</p>
</li>
<li><p>For each VM</p>
<p>a. Click the VM to edit the VM properties.</p>
<p>b. Under <em>Hardware</em>, select <strong>NICs</strong>.</p>
<p>c. Click <strong>Edit</strong>.</p>
<p><img src="images/vmw-vcd10.1-btn-vm-nics-edit.png" alt="Edit NICs option"></p>
<p>d. In the <em>Edit NICs</em> dialog box, from the <strong>Network</strong> list, select the vApp network.</p>
<p><img src="images/vmw-vcd10.1-vm-vapp-network.png" alt="VM connected to a vApp network"></p>
</li>
<li><p>If you want to dual-home your VM, click <strong>New</strong> to add a second network.</p>
</li>
<li><p>When you're done, click <strong>Save</strong>.</p>
</li>
<li><p>You can go back to the VM hardware properties to see the new IP address assigned to the VM.</p>
</li>
</ol>
<h2 id="viewing-and-adjusting-vapp-network-settings">Viewing and adjusting vApp network settings</h2>
<p>When you've created your vApp network and assigned VMs to it, you may want to review the vApp network settings and adjust them if needed.</p>
<ol>
<li><p>In the left navigation panel, select <strong>vApps</strong>.</p>
</li>
<li><p>In the card for the vApp, select <strong>Details</strong>.</p>
</li>
<li><p>Select <strong>Networks</strong>.</p>
</li>
<li><p>Click your vApp network to view its network settings.</p>
</li>
<li><p>The <em>General</em> page displays general network settings. Click <strong>Edit</strong> to adjust these settings.</p>
</li>
<li><p>The <em>IP Management</em> pages display the IP settings for the vApp network, including <strong>Static Pools</strong>, <strong>DNS</strong> and <strong>DHCP</strong>. Click <strong>Edit</strong> on these pages to adjust these settings.</p>
<p>For more information about enabling DHCP for your vApp network, see <a href="#enabling-dhcp">*Enabling DHCP</a>.</p>
</li>
<li><p>On the <em>Services</em> page you can set up firewall and NAT rules for your vApp network. For more information, see <a href="#creating-firewall-rules"><em>Creating firewall rules</em></a> and <a href="#creating-nat-rules"><em>Creating NAT rules</em></a>.</p>
</li>
<li><p>On the <em>Routing</em> page you can create static routes for your vApp network. For more information, see <a href="#creating-static-routes"><em>Creating static routes</em></a>.</p>
</li>
</ol>
<h3 id="enabling-dhcp">Enabling DHCP</h3>
<p>DHCP isn't enabled by default.</p>
<p>For more information about DHCP, see <a href="vmw-how-create-dhcp-pool.html"><em>How to create a DHCP pool</em></a>.</p>
<p>To enable DHCP:</p>
<ol>
<li><p>In the left navigation panel, select <strong>vApps</strong>.</p>
</li>
<li><p>In the card for the vApp, select <strong>Details</strong>.</p>
</li>
<li><p>Select <strong>Networks</strong>.</p>
</li>
<li><p>Click your vApp network to view its network settings.</p>
</li>
<li><p>Under <em>IP Management</em>, select <strong>DHCP</strong>.</p>
</li>
<li><p>Click <strong>Edit</strong>.</p>
<p><img src="images/vmw-vcd10.1-btn-vapp-network-dhcp-edit.png" alt="Edit button for vApp network DHCP"></p>
</li>
<li><p>In the <em>Edit network</em> dialog box, select the <strong>Enabled</strong> option.</p>
</li>
<li><p>Enter <strong>IP Pool</strong> and lease information for your DHCP addresses then click <strong>Save</strong>.</p>
<p><img src="images/vmw-vcd10.1-vapp-network-dhcp.png" alt="Edit network settings for DHCP"></p>
</li>
</ol>
<h3 id="creating-firewall-rules">Creating firewall rules</h3>
<p>There will be a rule in place to allow any traffic to traverse the firewall. You can amend or delete this rule, or create new rules.</p>
<p><img src="images/vmw-vcd-vapp-network-firewall.png" alt="vApp network firewall rules"></p>
<p>For more about firewall rules, see <a href="vmw-how-create-firewall-rules.html"><em>How to create firewall rules</em></a>.</p>
<p>To create a firewall rule:</p>
<ol>
<li><p>In the left navigation panel, select <strong>vApps</strong>.</p>
</li>
<li><p>In the card for the vApp, select <strong>Details</strong>.</p>
</li>
<li><p>Select <strong>Networks</strong>.</p>
</li>
<li><p>Click your vApp network to view its network settings.</p>
</li>
<li><p>Select <strong>Services</strong>.</p>
</li>
<li><p>Click <strong>Edit</strong>.</p>
<p><img src="images/vmw-vcd10.1-btn-vapp-network-services-edit.png" alt="Edit button for vApp network services"></p>
</li>
<li><p>On the <strong>Firewall</strong> tab, click <strong>Add</strong>, specify the details for the firewall rule then click <strong>Save</strong>.</p>
<p><img src="images/vmw-vcd10.1-vapp-network-firewall-add.png" alt="Add firewall rule"></p>
</li>
</ol>
<h3 id="creating-nat-rules">Creating NAT rules</h3>
<p>NAT rules, enabled by default, enable mapping between internal VM interfaces and external IP addresses.</p>
<p>For more information about NAT rules, see <a href="vmw-how-create-nat-rules.html"><em>How to create NAT rules</em></a>.</p>
<p>To edit the mapping rules for a VM:</p>
<ol>
<li><p>In the left navigation panel, select <strong>vApps</strong>.</p>
</li>
<li><p>In the card for the vApp, select <strong>Details</strong>.</p>
</li>
<li><p>Select <strong>Networks</strong>.</p>
</li>
<li><p>Click your vApp network to view its network settings.</p>
</li>
<li><p>Select <strong>Services</strong>.</p>
</li>
<li><p>Click <strong>Edit</strong>.</p>
<p><img src="images/vmw-vcd10.1-btn-vapp-network-services-edit.png" alt="Edit button for vApp network services"></p>
</li>
<li><p>Select the <strong>NAT</strong> tab.</p>
</li>
<li><p>From the <strong>NAT Type</strong> list, select <strong>IP Translation</strong>, then click <strong>Add</strong>.</p>
</li>
<li><p>In the <strong>VM Interface</strong> field, click the edit (pencil) icon, then select the VM interface for which you want to add the NAT rule, then click <strong>Keep</strong>.</p>
</li>
<li><p>From the <strong>Mapping Mode</strong> list, select the mapping mode.</p>
<p>The default mapping is <strong>Automatic</strong>. You can change this to <strong>Manual</strong>, in which case, enter an <strong>External IP</strong> address to which the VM can map.</p>
<p><img src="images/vmw-vcd10.1-vapp-network-nat-add.png" alt="Add NAT rule"></p>
</li>
<li><p>When you're done, click <strong>Save</strong>.</p>
<p>The external IP address will be on the same subnet as the VDC network that connects to the vApp edge.</p>
</li>
</ol>
<h3 id="creating-static-routes">Creating static routes</h3>
<p>Static routing at the vApp network level allows traffic to route between different vApp networks, across the VDC networks.</p>
<p>The prerequisites for static routing are as follows:</p>
<ul>
<li><p>Static routing must be enabled for the VDC network you're connecting to (see <a href="vmw-how-create-static-route.html"><em>How to create a static route</em></a>).</p>
</li>
<li><p>The two vApp networks must be routed to the same VDC network.</p>
</li>
<li><p>The vApp networks must be in vApps that have been started at least once.</p>
</li>
</ul>
<p>To add a static route:</p>
<ol>
<li><p>In the left navigation panel, select <strong>vApps</strong>.</p>
</li>
<li><p>In the card for the vApp, select <strong>Details</strong>.</p>
</li>
<li><p>Select <strong>Networks</strong>.</p>
</li>
<li><p>Click the first vApp network to view its network settings.</p>
</li>
<li><p>Select <strong>Routing</strong>.</p>
</li>
<li><p>Click <strong>Edit</strong>.</p>
<p><img src="images/vmw-vcd10.1-btn-vapp-network-static-route-enable.png" alt="Edit Static Routing option"></p>
</li>
<li><p>In the <em>Edit Static Routing Service</em> dialog box, select the <strong>Enable Static Routing</strong> option then click <strong>Save</strong>.</p>
<p><img src="images/vmw-vcd10.1-vapp-network-static-routing.png" alt="Edit Static Routing Service dialog box"></p>
</li>
<li><p>Click <strong>Add</strong>.</p>
<p><img src="images/vmw-vcd10.1-btn-vapp-network-static-route-add.png" alt="Add button for vApp network static route"></p>
</li>
<li><p>In the <em>Add Static Route</em> dialog box, enter a <strong>Name</strong> for the static route.</p>
</li>
<li><p>Enter the following details:</p>
<ul>
<li><p><strong>Network CIDR</strong> - The address of the first vApp network to which you're adding a static route</p>
</li>
<li><p><strong>Next Hop IP</strong> - The external IP address of that vApp network's router</p>
</li>
</ul>
<p><img src="images/vmw-vcd10.1-vapp-network-static-route.png" alt="Add Static Route dialog box"></p>
</li>
<li><p>When you're done, click <strong>Save</strong>.</p>
</li>
<li><p>Repeat for the second vApp network.</p>
</li>
</ol>
<h4 id="examples">Examples</h4>
<p>The tables below provides examples of the settings needed to create a static route between two vApps.</p>
<h5 id="network-information">Network information</h5>
<table>
<thead>
<tr>
<th>Network name</th>
<th>Network specification</th>
<th>Router external IP address</th>
</tr>
</thead>
<tbody>
<tr>
<td>vApp network 1</td>
<td><code>192.168.1.0/24</code></td>
<td><code>192.168.0.100</code></td>
</tr>
<tr>
<td>vApp network 2</td>
<td><code>192.168.2.0/24</code></td>
<td><code>192.168.0.101</code></td>
</tr>
<tr>
<td>VDC network shared</td>
<td><code>192.168.0.0/24</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h5 id="static-routing-settings">Static routing settings</h5>
<table>
<thead>
<tr>
<th>Static route to network</th>
<th>Route name</th>
<th>Network</th>
<th>Next hop IP address</th>
</tr>
</thead>
<tbody>
<tr>
<td>vApp network 1</td>
<td>To-vapp1</td>
<td><code>192.168.1.0/24</code></td>
<td><code>192.168.0.100</code></td>
</tr>
<tr>
<td>vApp network 2</td>
<td>To-vapp2</td>
<td><code>192.168.2.0/24</code></td>
<td><code>192.168.0.101</code></td>
</tr>
</tbody>
</table>
<div class="NOTE">
<h5>Note</h5>
<p>Make sure your firewall rules allow traffic on the static routes.</p>
</div>
<h2 id="vapp-fencing">vApp fencing</h2>
<p>Fencing a vApp allows identical VMs within different vApps to be powered on without conflict, by isolating the MAC and IP addresses of the VMs. This feature is particularly useful if you are copying vApps or creating catalog images of vApps where these details can't be altered.</p>
<p>vApp fencing can be done during or after vApp creation. It is done when the VMs within the vApp sit on the VDC network, rather than on their own vApp network.</p>
<p>To apply vApp fencing:</p>
<ol>
<li><p>In the left navigation panel, select <strong>vApps</strong>.</p>
</li>
<li><p>In the card for the vApp, select <strong>Details</strong>.</p>
</li>
<li><p>Select <strong>Networks</strong>.</p>
</li>
<li><p>In the <em>vApp Fencing</em> section, click <strong>Edit</strong>.</p>
<p><img src="images/vmw-vcd10.1-btn-vapp-network-fence.png" alt="Edit button for vApp network fencing"></p>
</li>
<li><p>Select the <strong>Fence vApp</strong> option then click <strong>OK</strong>.</p>
<p><img src="images/vmw-vcd-vapp-fencing.png" alt="Edit vApp Fencing dialog box"></p>
</li>
</ol>
<h2 id="feedback">Feedback</h2>
<p>If you find a problem with this article, click <strong>Improve this Doc</strong> to make the change yourself or raise an <a href="https://github.com/UKCloud/documentation/issues">issue</a> in GitHub. If you have an idea for how we could improve any of our services, send an email to <a href="mailto:feedback@ukcloud.com">feedback@ukcloud.com</a>.</p>


                  <div class="row">
                  </div>
                </article>
              </div>
              
              <div class="hidden-sm col-md-2" role="complementary">
                <div class="sideaffix">
                  <div class="toggle-mode">
                      <div class="icon">
                        <i aria-hidden="true">☀</i>
                      </div>
                      <label class="switch">
                        <input type="checkbox" id="switch-style">
                        <span class="slider round"></span>
                      </label>
                      <div class="icon">
                        <i aria-hidden="true">☾</i>
                      </div>
                      <script type="text/javascript" src="../../styles/toggle-theme.js"></script>
                  </div>
                  <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                  <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
                  </nav>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right text-right">
              Generated by <strong>DocFX</strong><br>
              <a href="#top">Back to top</a>
            </span>
            <span>&copy <a href="https://ukcloud.com">UKCloud Ltd</a>, 2021. All Rights Reserved.<br><a href="https://ukcloud.com/legal">Privacy Policy. </a><a href="https://ukcloud.com/terms-and-conditions">Terms of Use. </a><a href="https://docs.ukcloud.com/articles/other/other-how-contribute-knowledge.html">Contribute. </a></span>
          </div>
        </div>
      </footer>
      
      <div id="cookie-cta" style="display: none;" aria-hidden="true">
        <div class="cookie-cta-inner container">
          <div class="cookie-cta-text">
            <p>
              The <strong>UKCloud Knowledge Centre</strong> uses cookies to ensure that we give you the best experience on our website. If you continue we assume that you consent to receive all cookies on this website.
            </p>
          </div>
      
          <div class="cookie-cta-action">
            <button class="cookie-cta-close button button--small">Accept</button>
          </div>
        </div>
      </div>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
    <script type="text/javascript" src="../../styles/highlight.js"></script>
    <!-- Enable Terraform syntax highlighting -->
    <script type="text/javascript" src="../../styles/terraform.js"></script>
    <script type="text/javascript">
      hljs.registerLanguage('terraform', window.hljsDefineTerraform);
      hljs.initHighlightingOnLoad();
    </script>
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-57433193-6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'UA-57433193-6');
    </script>
  </body>
</html>
